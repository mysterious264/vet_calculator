<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <script>
        function numberFormat(a){
            a = "" + a;
            return a.split(".")[0] + "." + a.split(".")[1].slice(0,2);
        }

        var lowerLimit = 5;
        var upperLimit = 20;
        function test(){
            console.log("test");
            var wt = parseFloat($("#wt").val());
            var cnt = parseInt($("#cnt").val());
            if($("#species")[0].value == "rabbit"){
                lowerLimit = 5;
                upperLimit = 20;
            }else if($("#species")[0].value == "hamster"){
                lowerLimit = 10;
                upperLimit = 20;
            }else if($("#species")[0].value == "reptile"){
                lowerLimit = 3;
                upperLimit = 6;
            }
            var dataSet = [];

            dataSet.push(
               ["Drug A", wt*lowerLimit + "~" + wt*upperLimit, numberFormat(wt*lowerLimit/50) + "~" + numberFormat(wt*upperLimit/50), numberFormat(wt*lowerLimit/50*cnt) + "~" + numberFormat(wt*upperLimit/50*cnt)],
               ["Drug B", wt*lowerLimit + "~" + wt*upperLimit, numberFormat(wt*lowerLimit/40) + "~" + numberFormat(wt*upperLimit/40), numberFormat(wt*lowerLimit/40*cnt) + "~" + numberFormat(wt*upperLimit/40*cnt)],
               ["Drug C", wt*lowerLimit + "~" + wt*upperLimit, numberFormat(wt*lowerLimit/30) + "~" + numberFormat(wt*upperLimit/30), numberFormat(wt*lowerLimit/30*cnt) + "~" + numberFormat(wt*upperLimit/40*cnt)]
            );

            $('#table').DataTable( {
                "destroy": true,
                "pageLength": 100,
                data: dataSet,
                columns: [
                    { title: "Drug" },
                    { title: "Dosage" },
                    { title: "perDrug" },
                    { title: "tab" }
                ]
            } );
            var data = []
        }
    </script>
</head>
<body>
    <h1>Vet Calculator</h1>
    <select id="species" onchange="test();">
        <option value ="rabbit">兔子</option>
        <option value ="hamster">倉鼠</option>
        <option value="reptile">龜</option>
    </select>
    <br>
    Weight: <input id="wt" onchange="test();"></input> 公斤
    <br>
    份數: <input id="cnt" onchange="test();"></input> 份
    <br>
    <table id="table" class="display" width="100%"></table>
</body>
</html>
