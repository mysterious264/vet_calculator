<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        function numberFormat(a){
            a = "" + a;
            if(a.split(".").length == 2) {
                return a.split(".")[0] + "." + a.split(".")[1].slice(0,2);
            }else {
                return a;
            }
        }
        var lowerLimitDrugA = 0;
        var upperLimitDrugA = 0;
        var lowerLimitDrugB = 0;
        var upperLimitDrugB = 0;
        var lowerLimitDrugC = 0;
        var upperLimitDrugC = 0;
        function test(){
            console.log("test");
            var wt = parseFloat($("#wt").val());
            var cnt = parseInt($("#cnt").val());
            if($("#species")[0].value == "rabbit"){
              var lowerLimitDrugA = 5;
              var upperLimitDrugA = 20;
              var lowerLimitDrugB = 4;
              var upperLimitDrugB = 25;
              var lowerLimitDrugC = 5;
              var upperLimitDrugC = 30;
            }else if($("#species")[0].value == "hamster"){
              var lowerLimitDrugA = 4;
              var upperLimitDrugA = 8;
              var lowerLimitDrugB = 3;
              var upperLimitDrugB = 6;
              var lowerLimitDrugC = 7;
              var upperLimitDrugC = 14;
            }else if($("#species")[0].value == "reptile"){
              var lowerLimitDrugA = 4;
              var upperLimitDrugA = 8;
              var lowerLimitDrugB = 3;
              var upperLimitDrugB = 6;
              var lowerLimitDrugC = 7;
              var upperLimitDrugC = 14;
            }
            var dataSet = [];

            dataSet.push(
               ["Drug A", wt*lowerLimitDrugA + "~" + wt*upperLimitDrugA, numberFormat(wt*lowerLimitDrugA/50) + "~" + numberFormat(wt*upperLimitDrugA/50), numberFormat(wt*lowerLimitDrugA/50*cnt) + "~" + numberFormat(wt*upperLimitDrugA/50*cnt)],
               ["Drug B", wt*lowerLimitDrugB + "~" + wt*upperLimitDrugB, numberFormat(wt*lowerLimitDrugB/40) + "~" + numberFormat(wt*upperLimitDrugB/40), numberFormat(wt*lowerLimitDrugB/40*cnt) + "~" + numberFormat(wt*upperLimitDrugB/40*cnt)],
               ["Drug C", wt*lowerLimitDrugC + "~" + wt*upperLimitDrugC, numberFormat(wt*lowerLimitDrugC/30) + "~" + numberFormat(wt*upperLimitDrugC/30), numberFormat(wt*lowerLimitDrugC/30*cnt) + "~" + numberFormat(wt*upperLimitDrugC/30*cnt)]
            );

            $('#table').DataTable( {
                "destroy": true,
                "pageLength": 100,
                "autoWidth":false,
                data: dataSet,
                columns: [
                    { title: "Drug" },
                    { title: "Dosage" },
                    { title: "perDrug" },
                    { title: "tab" }
                ]
            } );
            $("#table").css("width","90%");
        }
    </script>
</head>
<body>
    <h1 class="text-center">Vet Calculator</h1>
    <div class="text-center">
        <select id="species" onchange="test();">
            <option value ="rabbit">兔子</option>
            <option value ="hamster">倉鼠</option>
            <option value="reptile">龜</option>
        </select>
        <br>
        Weight: <input id="wt" onchange="test();"></input> 公斤
        <br>
        份數: <input id="cnt" onchange="test();"></input> 份
        <br>
        <div width="95%">
            <table id="table" class="display" width="100%"></table>
        </div>
    </div>
</body>
</html>
